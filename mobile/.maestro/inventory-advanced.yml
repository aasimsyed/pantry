# Inventory Advanced Features Test
# Tests add, edit, and delete operations
# Note: Assumes user is logged in and has a pantry selected

appId: com.aasimsyed.smartpantry
---
- launchApp
# Wait for app to load - if on login screen, wait for home
- runFlow:
    when:
      visible: "Sign In"
    commands:
      - extendedWaitUntil:
          visible: "Smart Pantry"
          timeout: 5000
# Navigate to Inventory
- assertVisible:
    id: "home-title"
- tapOn:
    id: "quick-action-inventory"
- assertVisible: "Inventory"
# Verify inventory screen elements
- assertVisible:
    id: "inventory-search"
- assertVisible:
    id: "location-filter-all"
- assertVisible:
    id: "location-filter-pantry"
- assertVisible:
    id: "location-filter-fridge"
- assertVisible:
    id: "location-filter-freezer"
- assertVisible:
    id: "add-item-fab"
# Test location filters
- tapOn:
    id: "location-filter-pantry"
- tapOn:
    id: "location-filter-all"
# Test add item dialog
- tapOn:
    id: "add-item-fab"
# Verify dialog options are visible
- assertVisible: "Add Item"
- assertVisible:
    id: "add-item-take-photo"
- assertVisible:
    id: "add-item-choose-photo"
- assertVisible:
    id: "add-item-manual-entry"
# Test manual entry flow
- tapOn:
    id: "add-item-manual-entry"
# Verify manual entry form
- assertVisible: "Add Item Manually"
- assertVisible:
    id: "manual-entry-product-name"
- assertVisible:
    id: "manual-entry-brand"
- assertVisible:
    id: "manual-entry-cancel"
- assertVisible:
    id: "manual-entry-submit"
# Fill in manual entry form (but don't submit - requires API)
- tapOn:
    id: "manual-entry-product-name"
- inputText: "Test Product"
- hideKeyboard
# Cancel manual entry
- tapOn:
    id: "manual-entry-cancel"
# Test edit item (if items exist)
# Note: We check for items by looking for the search bar and location filters
# If items exist, we can try to tap on the first item
- runFlow:
    when:
      visible: "Inventory"
    commands:
      # Try to find and tap on an item if one exists
      # Note: Specific item IDs are dynamic, so we'll just verify the screen is ready
      # For actual item interaction, you'd need to know the specific item ID
      # Verify edit dialog
      - assertVisible: "Edit Item"
      - assertVisible:
          id: "edit-item-cancel"
      - assertVisible:
          id: "edit-item-save"
      # Cancel edit
      - tapOn:
          id: "edit-item-cancel"
# Note: Delete operation requires confirmation dialog
# which is handled by system Alert, so harder to test automatically
