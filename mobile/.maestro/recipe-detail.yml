# Recipe Detail Screen Test
# Tests viewing and interacting with recipe details
# Note: Requires a saved recipe or generated recipe to view

appId: com.aasimsyed.smartpantry
---
- launchApp
# Wait for app to load - if on login screen, wait for home
- runFlow:
    when:
      visible: "Sign In"
    commands:
      - extendedWaitUntil:
          visible: "Smart Pantry"
          timeout: 5000
# Navigate to Recipe Box first (to find a recipe)
- assertVisible:
    id: "home-title"
- tapOn:
    id: "quick-action-recipebox"
- assertVisible:
    id: "recipe-box-title"
# If recipes exist, open the first one
- runFlow:
    when:
      visible: "View"
    commands:
      # Tap the first "View" button (recipe-box-view-{id})
      # Note: We can't predict the exact ID, so we'll use text matching
      - tapOn: "View"
      # Verify recipe detail screen loaded
      - assertVisible:
          id: "recipe-detail-title"
      # Verify recipe details are visible
      - assertVisible:
          id: "recipe-detail-description"
      # Test servings slider (if it's a saved recipe)
      - runFlow:
          when:
            visible: "Scale Recipe"
          commands:
            - assertVisible:
                id: "recipe-servings-slider"
            - assertVisible:
                id: "servings-decrease"
            - assertVisible:
                id: "servings-reset"
            - assertVisible:
                id: "servings-increase"
      # Test edit notes & rating button (if it's a saved recipe)
      - runFlow:
          when:
            visible: "Edit Notes & Rating"
          commands:
            - tapOn:
                id: "edit-notes-rating-button"
            - assertVisible:
                id: "edit-notes-cancel"
            - assertVisible:
                id: "edit-notes-save"
            - tapOn:
                id: "edit-notes-cancel"
      # Navigate back
      - tapOn: "Main"
# If no recipes, verify empty state
- runFlow:
    when:
      visible: "No Recipes Yet"
    commands:
      - assertVisible: "No Recipes Yet"
